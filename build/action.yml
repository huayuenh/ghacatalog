name: Image Build
description: Image Build
runs:
  using: composite
  outputs:
    imagename: ${{ steps.build-image.outputs.imagename }}
    testval: ${{ steps.build-image.outputs.testval }}
  steps:
    - name: Build Image
      id: build-image
      shell: bash
      run: |
        IMAGE_URL="$REGISTRY_HOSTNAME"/"$ICR_NAMESPACE"/"$IMAGE_NAME":"$GITHUB_SHA"
        IMAGE_NAME="$ICR_NAMESPACE"/"$IMAGE_NAME":"$GITHUB_SHA"
        TEST_VAL="hello"
        docker build -t "$IMAGE_URL" \
          --build-arg GITHUB_SHA="$GITHUB_SHA" \
          --build-arg GITHUB_REF="$GITHUB_REF" .
        echo "imagename=${IMAGE_NAME}" >> "$GITHUB_OUTPUT"
        echo "testval=${TEST_VAL}" >> "$GITHUB_OUTPUT"
        echo "image name"
        echo $imagename
        echo "test val"
        echo $testval